{% assign thumbnail = include.item.thumbnail | default: site.thumbnail %}
{% if include.type %}
  {% assign img_src = '/assets/images/'
    | append: include.type
    | append: '/'
    | append: thumbnail
  %}
{% else %}
  {% assign img_src = '/assets/images/' | append: thumbnail %}
{% endif %}

<article
  class="card card-clickable h-100 position-relative"
  aria-labelledby="card-title-{{ include.item.title | slugify }}"
  aria-describedby="card-desc-{{ include.item.title | slugify }}"
>
  <a
    href="{{ include.item.url | relative_url }}"
    class="stretched-link text-reset"
  >
    <div class="row g-0 h-100">
      <div class="col-md-4 p-3">
        <img
          src="{{ img_src }}"
          class="img-fluid rounded w-100 object-fit-cover"
          alt="{{ include.item.title }}"
          style="height: 180px;"
        >
      </div>

      <div class="col-md-8 ps-md-4 card-body">
        <h3
          id="card-title-{{ include.item.title | slugify }}"
          class="card-title mt-0"
        >
          {% if include.item.featured %}
            <i
              class="fas fa-thumbtack fa-xs text-primary me-2"
              aria-label="Featured post"
            ></i>
          {% endif %}
          {{ include.item.title }}
        </h3>

        <div class="card-meta text-muted small mb-2">
          {% if include.type == 'project' %}
            {% if include.item.fromDate or include.item.toDate %}
              <span class="meta-item">
                <i class="fas fa-calendar" aria-hidden="true"></i>
                {% if include.item.fromDate and include.item.toDate %}
                  {{ include.item.fromDate | date: '%b %Y' }} â€“
                  {{ include.item.toDate | date: '%b %Y' }}
                {% elsif include.item.fromDate %}
                  From {{ include.item.fromDate | date: '%b %Y' }}
                {% elsif include.item.toDate %}
                  Until {{ include.item.toDate | date: '%b %Y' }}
                {% endif %}
              </span>
            {% endif %}
          {% else %}
            {% if include.item.date %}
              <span class="meta-item">
                <i class="fas fa-calendar" aria-hidden="true"></i>
                {{ include.item.date | date: '%b %-d, %Y' }}
              </span>
            {% endif %}

            {% if include.item.category %}
              <span class="meta-item">
                <i class="fas fa-folder" aria-hidden="true"></i>
                {{ include.item.category }}
              </span>
            {% endif %}

            {% if include.type == 'post' and include.item.content %}
              <span class="meta-item">
                {% include reading-time.html content=include.item.content %}
              </span>
            {% endif %}

            {% if include.item.authors and include.item.authors.size > 0 %}
              <span class="meta-item">
                <i class="fas fa-user" aria-hidden="true"></i>
                {% assign max_authors = site.max_authors_card | default: 2 %}
                {% assign display_authors = include.item.authors
                  | slice: 0, max_authors
                %}
                {% for author in display_authors %}
                  {{ author }}
                  {% unless forloop.last %}
                    {% if forloop.index == display_authors.size
                      and display_authors.size > 1
                    %}
                      and
                    {% else %}
                      ,
                    {% endif %}
                  {% endunless %}
                {% endfor %}
                {% if include.item.authors.size > max_authors %}
                  , and
                  {{ include.item.authors.size | minus: max_authors }} more
                {% endif %}
              </span>
            {% endif %}
          {% endif %}
        </div>

        {% if include.item.tags %}
          {% for tag in include.item.tags %}
            <span class="badge bg-secondary me-1">{{ tag }}</span>
          {% endfor %}
        {% endif %}

        <p
          id="card-desc-{{ include.item.title | slugify }}"
          class="card-text text-muted mt-2"
        >
          {% if include.item.description %}
            {{ include.item.description }}
          {% else %}
            {% if include.type == 'post' %}
              {{ include.item.excerpt }}
            {% else %}
              {{
                include.item.content
                | markdownify
                | strip_html
                | truncatewords: 30
              }}
            {% endif %}
          {% endif %}
        </p>
      </div>
    </div>
  </a>
</article>
